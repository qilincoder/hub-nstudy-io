import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as l,c as p,a as n,b as a,d as e,e as t}from"./app-CRfAIpjY.js";const c={},r=n("h1",{id:"docker支持gpu安装和配置",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#docker支持gpu安装和配置"},[n("span",null,"docker支持GPU安装和配置")])],-1),u=n("br",null,null,-1),d={href:"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html",target:"_blank",rel:"noopener noreferrer"},k=n("br",null,null,-1),v=t(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>nvidia-container-toolkit <span class="token parameter variable">-version</span>
NVIDIA Container Runtime Hook version <span class="token number">1.14</span>.3
commit: 53b24618a542025b108239fe602e66e912b7d6e2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装操作脚本" tabindex="-1"><a class="header-anchor" href="#安装操作脚本"><span>安装操作脚本</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://nvidia.github.io/libnvidia-container/gpgkey <span class="token operator">|</span> <span class="token function">sudo</span> gpg <span class="token parameter variable">--dearmor</span> <span class="token parameter variable">-o</span> /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg <span class="token punctuation">\\</span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-L</span> https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list <span class="token operator">|</span> <span class="token punctuation">\\</span>
    <span class="token function">sed</span> <span class="token string">&#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#39;</span> <span class="token operator">|</span> <span class="token punctuation">\\</span>
    <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/nvidia-container-toolkit.list <span class="token punctuation">\\</span>
  <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
    <span class="token function">sudo</span> <span class="token function">apt-get</span> update

<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> nvidia-container-toolkit

<span class="token function">sudo</span> nvidia-ctk runtime configure <span class="token parameter variable">--runtime</span><span class="token operator">=</span>docker

<span class="token function">cat</span> /etc/docker/daemon.json 
<span class="token punctuation">{</span>
    <span class="token string">&quot;default-runtime&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;nvidia&quot;</span>,

    <span class="token string">&quot;bip&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;192.168.88.1/24&quot;</span>,
    <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;https://docker.nju.edu.cn&quot;</span>
    <span class="token punctuation">]</span>,
    <span class="token string">&quot;runtimes&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;nvidia&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;args&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>,
            <span class="token string">&quot;path&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;nvidia-container-runtime&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>

<span class="token function">sudo</span> <span class="token function">docker</span> run <span class="token parameter variable">--rm</span> <span class="token parameter variable">--runtime</span><span class="token operator">=</span>nvidia <span class="token parameter variable">--gpus</span> all ubuntu nvidia-smi

<span class="token function">vim</span> /usr/local/bin/nvidia-docker

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="nvidia-docker-脚本" tabindex="-1"><a class="header-anchor" href="#nvidia-docker-脚本"><span>nvidia-docker 脚本</span></a></h1>`,4),b=n("br",null,null,-1),m={href:"https://github.com/NVIDIA/nvidia-docker/blob/v2.13.0/nvidia-docker",target:"_blank",rel:"noopener noreferrer"},g=n("br",null,null,-1),h=t(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#! /bin/bash</span>
<span class="token comment"># Copyright (c) 2017-2018, NVIDIA CORPORATION. All rights reserved.</span>

<span class="token assign-left variable">NV_DOCKER</span><span class="token operator">=</span><span class="token variable">\${NV_DOCKER<span class="token operator">:-</span>&quot;docker&quot;}</span>

<span class="token assign-left variable">DOCKER_ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token assign-left variable">NV_DOCKER_ARGS</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token parameter variable">-gt</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">arg</span><span class="token operator">=</span><span class="token variable">$1</span>
    <span class="token builtin class-name">shift</span>
    <span class="token assign-left variable">DOCKER_ARGS</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token variable">$arg</span>&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token variable">$arg</span> <span class="token keyword">in</span>
        run<span class="token operator">|</span>create<span class="token punctuation">)</span>
            <span class="token assign-left variable">NV_DOCKER_ARGS</span><span class="token operator">+=</span><span class="token punctuation">(</span><span class="token string">&quot;--runtime=nvidia&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable">\${NV_GPU}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token assign-left variable">NV_DOCKER_ARGS</span><span class="token operator">+=</span><span class="token punctuation">(</span>-e <span class="token assign-left variable">NVIDIA_VISIBLE_DEVICES</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">\${NV_GPU<span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token operator">,</span>}</span>&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">fi</span>
            <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
        version<span class="token punctuation">)</span>
            <span class="token builtin class-name">printf</span> <span class="token string">&quot;NVIDIA Docker: @VERSION@<span class="token entity" title="\\n">\\n</span>&quot;</span>
            <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
        --<span class="token punctuation">)</span>
            <span class="token builtin class-name">break</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">done</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-z</span> <span class="token variable">$NV_DEBUG</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">set</span> <span class="token parameter variable">-x</span>
<span class="token keyword">fi</span>

<span class="token builtin class-name">exec</span> <span class="token variable">$NV_DOCKER</span> <span class="token string">&quot;<span class="token variable">\${DOCKER_ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token string">&quot;<span class="token variable">\${NV_DOCKER_ARGS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function _(f,q){const s=o("ExternalLinkIcon");return l(),p("div",null,[r,n("blockquote",null,[n("p",null,[a("本实践将在 Ubuntu 22.04.3LTS 系统上进行安装测试"),u,a(" 参考资料 : "),n("a",d,[a("nvidia-container-toolkit"),e(s)]),k,a(" 目前安装版本")])]),v,n("blockquote",null,[n("p",null,[a("新版本nvidia-docker命令行已经移除"),b,a(" nvidia-docker参考 : "),n("a",m,[a("nvidia-docker"),e(s)]),g,a(" nvidia-docker")])]),h])}const N=i(c,[["render",_],["__file","45e2b4.html.vue"]]),G=JSON.parse(`{"path":"/p2024/Docker/45e2b4.html","title":"GPU_nvidia-container-toolkit安装和配置","lang":"zh-CN","frontmatter":{"permalink":"/p2024/Docker/45e2b4.html","lang":"zh-CN","title":"GPU_nvidia-container-toolkit安装和配置","description":"GPU_nvidia-container-toolkit安装和配置","isOriginal":true,"date":"2024-03-28T00:00:00.000Z","category":["Docker","GPU"],"tag":["Docker","GPU"],"head":[["meta",{"name":"keywords","content":"GPU_nvidia-container-toolkit安装和配置,GPU,nvidia-container-toolkit"}],["meta",{"property":"og:url","content":"https://hub.nstudy.org/p2024/Docker/45e2b4.html"}],["meta",{"property":"og:site_name","content":"Jack's 新学习基地"}],["meta",{"property":"og:title","content":"GPU_nvidia-container-toolkit安装和配置"}],["meta",{"property":"og:description","content":"GPU_nvidia-container-toolkit安装和配置"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-09T03:22:27.000Z"}],["meta",{"property":"article:author","content":"Jack"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:tag","content":"GPU"}],["meta",{"property":"article:published_time","content":"2024-03-28T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-09T03:22:27.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"GPU_nvidia-container-toolkit安装和配置\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-28T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-09T03:22:27.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jack\\",\\"url\\":\\"https://hub.nstudy.org\\"}]}"]],"star":true,"sticky":true},"headers":[{"level":2,"title":"安装操作脚本","slug":"安装操作脚本","link":"#安装操作脚本","children":[]}],"git":{"createdTime":1712632947000,"updatedTime":1712632947000,"contributors":[{"name":"lizhiquan","email":"lizhiquan@jianke.com","commits":1}]},"readingTime":{"minutes":1.03,"words":309},"filePathRelative":"02.Docker/20240328_GPU_nvidia-container-toolkit.md","localizedDate":"2024年3月28日","excerpt":"\\n<blockquote>\\n<p>本实践将在 Ubuntu 22.04.3LTS 系统上进行安装测试<br>\\n参考资料 : <a href=\\"https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">nvidia-container-toolkit</a><br>\\n目前安装版本</p>\\n</blockquote>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code>nvidia-container-toolkit <span class=\\"token parameter variable\\">-version</span>\\nNVIDIA Container Runtime Hook version <span class=\\"token number\\">1.14</span>.3\\ncommit: 53b24618a542025b108239fe602e66e912b7d6e2\\n</code></pre></div>"}`);export{N as comp,G as data};
