import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as a,c as s,e}from"./app-CcdNUK7S.js";const t={},p=e(`<h2 id="实现目标" tabindex="-1"><a class="header-anchor" href="#实现目标"><span>实现目标</span></a></h2><blockquote><p>因上传某盘等文件大小限制，无法上传视频，故需要对视频进行压缩</p></blockquote><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><blockquote><p>ffmpeg文档参考: <code>https://ffmpeg.org/ffmpeg.html</code></p></blockquote><h2 id="依赖条件" tabindex="-1"><a class="header-anchor" href="#依赖条件"><span>依赖条件</span></a></h2><blockquote><p>已经安装好python3.11 ，原则上更高版本也可以<br> 安装 ffmpeg 依赖 <code>pip install ffmpeg-python</code></p></blockquote><h2 id="实现代码" tabindex="-1"><a class="header-anchor" href="#实现代码"><span>实现代码</span></a></h2><blockquote><p>主代码</p></blockquote><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># @Time    : 2024-04-15 13:29</span>
<span class="token comment"># @Author  : Jack</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
pip install ffmpeg-python
&quot;&quot;&quot;</span>

<span class="token keyword">import</span> ffmpeg


<span class="token keyword">def</span> <span class="token function">cut_video</span><span class="token punctuation">(</span>video_path<span class="token operator">=</span><span class="token string">r&#39;F:\\11\\5.mkv&#39;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    video_path <span class="token operator">=</span> video_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;\\\\&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span>
    output_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>video_path<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">/output.mkv&quot;</span></span>

    start_time <span class="token operator">=</span> <span class="token string">&#39;00:00:00&#39;</span>
    end_time <span class="token operator">=</span> <span class="token string">&#39;00:52:10&#39;</span>

    input_stream <span class="token operator">=</span> ffmpeg<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span>video_path<span class="token punctuation">,</span> ss<span class="token operator">=</span>start_time<span class="token punctuation">)</span>
    output_stream <span class="token operator">=</span> ffmpeg<span class="token punctuation">.</span>output<span class="token punctuation">(</span>input_stream<span class="token punctuation">,</span> output_file<span class="token punctuation">,</span> to<span class="token operator">=</span>end_time<span class="token punctuation">)</span>
    ffmpeg<span class="token punctuation">.</span>run<span class="token punctuation">(</span>output_stream<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;视频分割完成&#39;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    cut_video<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="其他问题" tabindex="-1"><a class="header-anchor" href="#其他问题"><span>其他问题</span></a></h2><h3 id="选择性截取视频通道" tabindex="-1"><a class="header-anchor" href="#选择性截取视频通道"><span>选择性截取视频通道</span></a></h3><blockquote><p>以下代码实现视频剪辑，保留第一个视频通道，第一个音频通道，保留前三个字幕通道<br><code>python代码暂未实现多个map的映射关系</code></p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 正确的命令行</span>
ffmpeg <span class="token parameter variable">-i</span> <span class="token number">5</span>.mkv <span class="token parameter variable">-ss</span> 00:00:00 <span class="token parameter variable">-to</span> 00:01:00 <span class="token parameter variable">-map</span> <span class="token number">0</span>:v:0 <span class="token parameter variable">-map</span> <span class="token number">0</span>:a:0 <span class="token parameter variable">-map</span> <span class="token number">0</span>:s <span class="token parameter variable">-c:v</span> copy -c:a:0 copy <span class="token parameter variable">-c:s</span> copy output.mkv
ffmpeg <span class="token parameter variable">-i</span> <span class="token number">5</span>.mkv <span class="token parameter variable">-ss</span> 00:00:00 <span class="token parameter variable">-to</span> 00:01:00 <span class="token parameter variable">-map</span> <span class="token number">0</span>:v:0 <span class="token parameter variable">-map</span> <span class="token number">0</span>:a:0 <span class="token parameter variable">-map</span> <span class="token number">0</span>:s:0 <span class="token parameter variable">-map</span> <span class="token number">0</span>:s:1 <span class="token parameter variable">-map</span> <span class="token number">0</span>:s:2 <span class="token parameter variable">-c:v</span> copy -c:a:0 copy -c:s:0 copy -c:s:1 copy -c:s:2 copy output.mkv
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="改变码率" tabindex="-1"><a class="header-anchor" href="#改变码率"><span>改变码率</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 获取当前视频码率</span>
ffprobe <span class="token parameter variable">-v</span> error <span class="token parameter variable">-show_entries</span> <span class="token assign-left variable">format</span><span class="token operator">=</span>bit_rate <span class="token parameter variable">-of</span> <span class="token assign-left variable">default</span><span class="token operator">=</span>noprint_wrappers<span class="token operator">=</span><span class="token number">1</span>:nokey<span class="token operator">=</span><span class="token number">1</span> <span class="token number">5</span>.mkv

<span class="token comment"># 输出 11873582 ==&gt; 11,873,582/1,000,000 = 11.873582 Mbps</span>

ffmpeg <span class="token parameter variable">-i</span> <span class="token number">5</span>.mkv <span class="token parameter variable">-b:v</span> 10M output.mkv
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="视频码率介绍" tabindex="-1"><a class="header-anchor" href="#视频码率介绍"><span>视频码率介绍</span></a></h3><blockquote><p>码率：码率是视频或音频的传输速度，单位是比特/秒（bps），通常以千比特/秒（kbps）为单位。高动态范围（HDR）和高分辨率（如4K、8K）视频通常需要更高的码率来保持高质量的播放体验。具体的码率取决于视频内容的复杂性、编码器的效率以及压缩技术的使用等因素。一般来说，以下是一些典型的推荐码率范围：</p></blockquote><ol><li><p><strong>高动态范围（HDR）视频</strong>：</p><ul><li>1080p HDR视频：通常在15-25 Mbps之间。</li><li>4K HDR视频：通常在25-45 Mbps之间。</li><li>8K HDR视频：通常在50 Mbps以上。</li></ul></li><li><p><strong>高分辨率视频</strong>：</p><ul><li>4K视频：通常在20-45 Mbps之间，具体取决于帧率和内容复杂性。</li><li>8K视频：通常在50-100 Mbps之间，具体取决于帧率和内容复杂性。</li></ul></li></ol><blockquote><p>这些数值仅供参考，实际的码率可能会因视频内容、压缩技术和编解码器的使用而有所不同。对于在线视频平台和流媒体服务商来说，他们通常会根据他们的平台和用户体验的需求来选择适当的码率。</p></blockquote>`,19),o=[p];function l(i,c){return a(),s("div",null,o)}const d=n(t,[["render",l],["__file","487b87.html.vue"]]),m=JSON.parse(`{"path":"/p2024/Python/487b87.html","title":"python实现视频剪辑","lang":"zh-CN","frontmatter":{"permalink":"/p2024/Python/487b87.html","lang":"zh-CN","title":"python实现视频剪辑","description":"python实现视频剪辑","isOriginal":true,"date":"2024-04-15T00:00:00.000Z","category":["python","ffmpeg"],"tag":["python","ffmpeg"],"head":[["meta",{"name":"keywords","content":"python实现视频剪辑, python,ffmpeg"}],["meta",{"property":"og:url","content":"https://hub.nstudy.org/p2024/Python/487b87.html"}],["meta",{"property":"og:site_name","content":"Jack's 新学习基地"}],["meta",{"property":"og:title","content":"python实现视频剪辑"}],["meta",{"property":"og:description","content":"python实现视频剪辑"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-19T07:50:23.000Z"}],["meta",{"property":"article:author","content":"Jack"}],["meta",{"property":"article:tag","content":"python"}],["meta",{"property":"article:tag","content":"ffmpeg"}],["meta",{"property":"article:published_time","content":"2024-04-15T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-19T07:50:23.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"python实现视频剪辑\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-04-15T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-19T07:50:23.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jack\\",\\"url\\":\\"https://hub.nstudy.org\\"}]}"]],"star":true,"sticky":true},"headers":[{"level":2,"title":"实现目标","slug":"实现目标","link":"#实现目标","children":[]},{"level":2,"title":"参考资料","slug":"参考资料","link":"#参考资料","children":[]},{"level":2,"title":"依赖条件","slug":"依赖条件","link":"#依赖条件","children":[]},{"level":2,"title":"实现代码","slug":"实现代码","link":"#实现代码","children":[]},{"level":2,"title":"其他问题","slug":"其他问题","link":"#其他问题","children":[{"level":3,"title":"选择性截取视频通道","slug":"选择性截取视频通道","link":"#选择性截取视频通道","children":[]},{"level":3,"title":"改变码率","slug":"改变码率","link":"#改变码率","children":[]},{"level":3,"title":"视频码率介绍","slug":"视频码率介绍","link":"#视频码率介绍","children":[]}]}],"git":{"createdTime":1713513023000,"updatedTime":1713513023000,"contributors":[{"name":"lizhiquan","email":"lizhiquan@jianke.com","commits":1}]},"readingTime":{"minutes":2.35,"words":705},"filePathRelative":"05.Python/20240415_python实现视频剪辑.md","localizedDate":"2024年4月15日","excerpt":"<h2>实现目标</h2>\\n<blockquote>\\n<p>因上传某盘等文件大小限制，无法上传视频，故需要对视频进行压缩</p>\\n</blockquote>\\n<h2>参考资料</h2>\\n<blockquote>\\n<p>ffmpeg文档参考: <code>https://ffmpeg.org/ffmpeg.html</code></p>\\n</blockquote>\\n<h2>依赖条件</h2>\\n<blockquote>\\n<p>已经安装好python3.11 ，原则上更高版本也可以<br>\\n安装 ffmpeg 依赖 <code>pip install ffmpeg-python</code></p>\\n</blockquote>"}`);export{d as comp,m as data};
