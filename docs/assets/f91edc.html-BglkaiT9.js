import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e}from"./app-r-0ZWJuU.js";const t={},l=e(`<h2 id="操作环境说明-本操作基于proxmox-ve-8-1-0实操" tabindex="-1"><a class="header-anchor" href="#操作环境说明-本操作基于proxmox-ve-8-1-0实操"><span>操作环境说明，本操作基于proxmox-ve: 8.1.0实操</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># root@:~# pveversion -v</span>
proxmox-ve: <span class="token number">8.1</span>.0 <span class="token punctuation">(</span>running kernel: <span class="token number">6.5</span>.11-7-pve<span class="token punctuation">)</span>
pve-manager: <span class="token number">8.1</span>.3 <span class="token punctuation">(</span>running version: <span class="token number">8.1</span>.3/b46aac3b42da5d15<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="背景介绍" tabindex="-1"><a class="header-anchor" href="#背景介绍"><span>背景介绍</span></a></h2><blockquote><p>在使用PVE使用过程中，虚拟机和docker都需要使用文件系统，且我想在docker，虚拟机，主机之间实现文件共享。考虑了很多方案，从安全、实用、简单等方便最后选择NFS共享方案来实现网内文件共享。</p></blockquote><h2 id="操作步骤" tabindex="-1"><a class="header-anchor" href="#操作步骤"><span>操作步骤</span></a></h2><h3 id="服务端" tabindex="-1"><a class="header-anchor" href="#服务端"><span>服务端</span></a></h3><ul><li>安装 NFS 服务</li></ul><h5 id="apt-会自动安装-nfs-common、rpcbind-等软件包" tabindex="-1"><a class="header-anchor" href="#apt-会自动安装-nfs-common、rpcbind-等软件包"><span>apt 会自动安装 nfs-common、rpcbind 等软件包</span></a></h5><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> nfs-kernel-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>检查服务</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>systemctl list-unit-files <span class="token operator">|</span> <span class="token function">grep</span> nfs-kernel-server
systemctl <span class="token builtin class-name">enable</span> nfs-kernel-server
systemctl status nfs-kernel-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>编写配置文件</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 我开启了两段网络的访问权限, 一个是docker网络（192.168.2xx.0/24），一个是主机所在网络（192.168.1xx.0/24）</span>
<span class="token function">nano</span> /etc/exports
<span class="token comment">#[任意主机所有权限]</span>
/mnt/ssd/data/nfs       <span class="token number">192.168</span>.1xx.0/24<span class="token punctuation">(</span>rw,fsid<span class="token operator">=</span><span class="token number">0</span>,crossmnt,sync,insecure,no_subtree_check,no_root_squash<span class="token punctuation">)</span>
/mnt/ssd/data/nfs       <span class="token number">192.168</span>.2xx.0/24<span class="token punctuation">(</span>rw,fsid<span class="token operator">=</span><span class="token number">0</span>,crossmnt,sync,insecure,no_subtree_check,no_root_squash<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>重启 NFS 服务</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>systemctl restart nfs-kernel-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>常用命令工具</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#在安装 NFS 服务器时，已包含常用的命令行工具，无需额外安装</span>
<span class="token comment">#显示已经 mount 到本机 NFS 目录的客户端机器</span>
showmount <span class="token parameter variable">-e</span> localhost
<span class="token comment">#将配置文件中的目录全部重新 export 一次，无需重启服务</span>
<span class="token function">sudo</span> exportfs <span class="token parameter variable">-rv</span>
<span class="token comment">#查看 NFS 的运行状态</span>
<span class="token function">sudo</span> nfsstat
<span class="token comment">#查看 rpc 执行信息，可以用于检测 rpc 运行情况</span>
<span class="token function">sudo</span> rpcinfo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="客户端" tabindex="-1"><a class="header-anchor" href="#客户端"><span>客户端</span></a></h3><ul><li>安装客户端工具</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#在需要连接到 NFS 服务器的客户端机器上，</span>
<span class="token comment">#需要执行以下命令，安装 nfs-common 软件包。</span>
<span class="token comment">#apt 会自动安装 nfs-common、rpcbind 等软件包</span>
<span class="token function">apt</span> <span class="token function">install</span> nfs-common
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看 NFS 服务器上的共享目录</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#显示指定的 NFS 服务器上 export 出来的目录</span>
<span class="token comment"># 192.168.xxx.xxx 为NFS服务器IP地址</span>
showmount <span class="token parameter variable">-e</span> <span class="token number">192.168</span>.1xx.xxx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>创建本地挂载目录</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /nfs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>挂载共享目录</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">mount</span> <span class="token parameter variable">-t</span> nfs4 <span class="token number">192.168</span>.1xx.xxx:/  /nfs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>设置开机启动自动挂载</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">nano</span> /etc/fstab
<span class="token number">192.168</span>.1xx.xxx:/    /nfs    nfs4     defaults        <span class="token number">0</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>查看客户端挂载信息</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span>
<span class="token function">df</span> <span class="token parameter variable">-h</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,30),i=[l];function c(r,o){return s(),a("div",null,i)}const u=n(t,[["render",c],["__file","f91edc.html.vue"]]),m=JSON.parse(`{"path":"/p2024/Linux/PVE/f91edc.html","title":"PVE安装NFS并使用","lang":"zh-CN","frontmatter":{"permalink":"/p2024/Linux/PVE/f91edc.html","lang":"zh-CN","title":"PVE安装NFS并使用","description":"PVE安装NFS并使用","isOriginal":true,"date":"2024-02-03T00:00:00.000Z","category":["PVE","NFS"],"tag":["PVE","NFS"],"head":[["meta",{"name":"keywords","content":"PVE,NFS"}],["meta",{"property":"og:url","content":"https://hub.nstudy.org/p2024/Linux/PVE/f91edc.html"}],["meta",{"property":"og:site_name","content":"Jack's 新学习基地"}],["meta",{"property":"og:title","content":"PVE安装NFS并使用"}],["meta",{"property":"og:description","content":"PVE安装NFS并使用"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T10:30:28.000Z"}],["meta",{"property":"article:author","content":"Jack"}],["meta",{"property":"article:tag","content":"PVE"}],["meta",{"property":"article:tag","content":"NFS"}],["meta",{"property":"article:published_time","content":"2024-02-03T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T10:30:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"PVE安装NFS并使用\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-02-03T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-12T10:30:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jack\\",\\"url\\":\\"https://hub.nstudy.org\\"}]}"]],"star":true,"sticky":true},"headers":[{"level":2,"title":"操作环境说明，本操作基于proxmox-ve: 8.1.0实操","slug":"操作环境说明-本操作基于proxmox-ve-8-1-0实操","link":"#操作环境说明-本操作基于proxmox-ve-8-1-0实操","children":[]},{"level":2,"title":"背景介绍","slug":"背景介绍","link":"#背景介绍","children":[]},{"level":2,"title":"操作步骤","slug":"操作步骤","link":"#操作步骤","children":[{"level":3,"title":"服务端","slug":"服务端","link":"#服务端","children":[]},{"level":3,"title":"客户端","slug":"客户端","link":"#客户端","children":[]}]}],"git":{"createdTime":1712917828000,"updatedTime":1712917828000,"contributors":[{"name":"lizhiquan","email":"lizhiquan@jianke.com","commits":1}]},"readingTime":{"minutes":1.86,"words":557},"filePathRelative":"06.Linux/88.PVE/20240203_PVE安装NFS并使用.md","localizedDate":"2024年2月3日","excerpt":"<h2>操作环境说明，本操作基于proxmox-ve: 8.1.0实操</h2>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token comment\\"># root@:~# pveversion -v</span>\\nproxmox-ve: <span class=\\"token number\\">8.1</span>.0 <span class=\\"token punctuation\\">(</span>running kernel: <span class=\\"token number\\">6.5</span>.11-7-pve<span class=\\"token punctuation\\">)</span>\\npve-manager: <span class=\\"token number\\">8.1</span>.3 <span class=\\"token punctuation\\">(</span>running version: <span class=\\"token number\\">8.1</span>.3/b46aac3b42da5d15<span class=\\"token punctuation\\">)</span>\\n</code></pre></div>"}`);export{u as comp,m as data};
