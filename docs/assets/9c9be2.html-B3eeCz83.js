import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as e,c as a,e as t}from"./app-r-0ZWJuU.js";const l={},s=t(`<h2 id="机器环境" tabindex="-1"><a class="header-anchor" href="#机器环境"><span>机器环境</span></a></h2><blockquote><p>本实践将在 Ubuntu 22.04.3LTS 系统上进行安装测试<br> docker 版本<code>Docker Engine - Community 24.0.6</code> ，原则上docker版本无影响</p></blockquote><h2 id="背景" tabindex="-1"><a class="header-anchor" href="#背景"><span>背景</span></a></h2><blockquote><p>安装k8s 集群时，flannel 网络会占用 cni0 和 flannel.1 两个网卡，导致无法安装 flannel 网络。可能机器上之前残留了 flannel 网络，导致无法安装 flannel 网络。<br> 下面方法清理已经存在的flannel网络</p></blockquote><h2 id="清除flannel网络" tabindex="-1"><a class="header-anchor" href="#清除flannel网络"><span>清除flannel网络</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>
<span class="token function">ifconfig</span> cni0 down
<span class="token function">ifconfig</span> flannel.1 down
<span class="token function">ifconfig</span> del flannel.1
<span class="token function">ifconfig</span> del cni0

<span class="token function">ip</span> <span class="token function">link</span> del flannel.1
<span class="token function">ip</span> <span class="token function">link</span> del cni0

<span class="token comment"># 如果没有 brctl 命令</span>
<span class="token function">apt</span> <span class="token function">install</span> bridge-utils

brctl delbr  flannel.1
brctl delbr cni0
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/cni/flannel/* <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/cni/networks/cbr0/* <span class="token operator">&amp;&amp;</span> <span class="token function">ip</span> <span class="token function">link</span> delete cni0 <span class="token operator">&amp;&amp;</span>  <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/cni/network/cni0/*

<span class="token comment"># 重启网络</span>
<span class="token function">service</span> network restart
<span class="token function">sudo</span> systemctl restart NetworkManager
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),i=[s];function c(o,r){return e(),a("div",null,i)}const m=n(l,[["render",c],["__file","9c9be2.html.vue"]]),u=JSON.parse(`{"path":"/p2024/Docker/9c9be2.html","title":"清除flannel网络","lang":"zh-CN","frontmatter":{"permalink":"/p2024/Docker/9c9be2.html","lang":"zh-CN","title":"清除flannel网络","description":"清除flannel网络","isOriginal":true,"date":"2024-03-30T00:00:00.000Z","category":["docker","flannel"],"tag":["docker","flannel"],"head":[["meta",{"name":"keywords","content":"清除flannel网络,docker"}],["meta",{"property":"og:url","content":"https://hub.nstudy.org/p2024/Docker/9c9be2.html"}],["meta",{"property":"og:site_name","content":"Jack's 新学习基地"}],["meta",{"property":"og:title","content":"清除flannel网络"}],["meta",{"property":"og:description","content":"清除flannel网络"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T10:30:28.000Z"}],["meta",{"property":"article:author","content":"Jack"}],["meta",{"property":"article:tag","content":"docker"}],["meta",{"property":"article:tag","content":"flannel"}],["meta",{"property":"article:published_time","content":"2024-03-30T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T10:30:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"清除flannel网络\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-30T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-12T10:30:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jack\\",\\"url\\":\\"https://hub.nstudy.org\\"}]}"]],"star":true,"sticky":true},"headers":[{"level":2,"title":"机器环境","slug":"机器环境","link":"#机器环境","children":[]},{"level":2,"title":"背景","slug":"背景","link":"#背景","children":[]},{"level":2,"title":"清除flannel网络","slug":"清除flannel网络","link":"#清除flannel网络","children":[]}],"git":{"createdTime":1712917828000,"updatedTime":1712917828000,"contributors":[{"name":"lizhiquan","email":"lizhiquan@jianke.com","commits":1}]},"readingTime":{"minutes":0.7,"words":211},"filePathRelative":"02.Docker/20240330_清除flannel网络.md","localizedDate":"2024年3月30日","excerpt":"<h2>机器环境</h2>\\n<blockquote>\\n<p>本实践将在 Ubuntu 22.04.3LTS 系统上进行安装测试<br>\\ndocker 版本<code>Docker Engine - Community 24.0.6</code> ，原则上docker版本无影响</p>\\n</blockquote>\\n<h2>背景</h2>\\n<blockquote>\\n<p>安装k8s 集群时，flannel 网络会占用 cni0 和 flannel.1 两个网卡，导致无法安装 flannel 网络。可能机器上之前残留了 flannel 网络，导致无法安装 flannel 网络。<br>\\n下面方法清理已经存在的flannel网络</p>\\n</blockquote>"}`);export{m as comp,u as data};
