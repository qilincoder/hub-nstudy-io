import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as l,o as i,c,a as n,b as s,d as a,e as t}from"./app-0RuRy7YQ.js";const o={},r=n("h2",{id:"背景介绍",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#背景介绍"},[n("span",null,"背景介绍")])],-1),u={href:"https://example.com",target:"_blank",rel:"noopener noreferrer"},d=t(`<blockquote><p>如果您不是迫不得已，建议使用nginx等web服务器已获得顺畅的https服务</p></blockquote><blockquote><p>nginx SSL 证书配置如下</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>    listen <span class="token number">443</span> ssl http2<span class="token punctuation">;</span>
    listen <span class="token punctuation">[</span>::<span class="token punctuation">]</span>:443 ssl http2<span class="token punctuation">;</span>
    ssl_certificate         /etc/nginx/cert/fullchain.pem<span class="token punctuation">;</span>
    ssl_certificate_key     /etc/nginx/cert/privkey.key<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="环境介绍以及依赖版本介绍" tabindex="-1"><a class="header-anchor" href="#环境介绍以及依赖版本介绍"><span>环境介绍以及依赖版本介绍</span></a></h2><blockquote><p>你已经通过其他途径申请到了 <code>example.com</code> 的SSL证书，证书包含两个文件 <code>fullchain.pem</code> pem证书文件 <code>privkey.pem</code> pem私钥文件<br> windows服务器(我的是windows10)，已经安装IIS<br> 这里假设您已经熟练操作IIS</p></blockquote>`,5),k={href:"https://example.com",target:"_blank",rel:"noopener noreferrer"},m=n("code",null,"您导入的证书接口",-1),v=n("li",null,[n("code",null,"您导入的证书接口"),s(" 此时还不可用，本文的目的就是导入证书，然后在IIS中的证书选择中可以选择到导入的证书。")],-1),h=t(`<blockquote><p>您已经在您的域名管理的DNS管理中正确添加了DNS解析记录</p></blockquote><h2 id="操作方法" tabindex="-1"><a class="header-anchor" href="#操作方法"><span>操作方法</span></a></h2><h3 id="方案1" tabindex="-1"><a class="header-anchor" href="#方案1"><span>方案1</span></a></h3><blockquote><p>如果您的电脑已经安装 <code>openssl</code> , 则直接转换证书即可</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 测试您的电脑是否安装openssl</span>
openssl <span class="token builtin class-name">help</span>

Standard commands
asn1parse         ca                ciphers           cms
crl               crl2pkcs7         dgst              dhparam
dsa               dsaparam          ec                ecparam
enc               engine            errstr            gendsa
genpkey           genrsa            <span class="token builtin class-name">help</span>              list
nseq              ocsp              <span class="token function">passwd</span>            pkcs12
pkcs7             pkcs8             pkey              pkeyparam
pkeyutl           prime             rand              rehash
req               rsa               rsautl            s_client
s_server          s_time            sess_id           smime
speed             spkac             srp               storeutl
ts                verify            version           x509

<span class="token comment"># 直接转换证书</span>

openssl pkcs12 <span class="token parameter variable">-export</span> <span class="token parameter variable">-out</span> example.com.pfx <span class="token parameter variable">-inkey</span> privkey.pem <span class="token parameter variable">-in</span> fullchain.pem

<span class="token comment"># 需要输入密码 xxxxxx</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>文件 <code>example.com.pfx</code> 即使转换的 windowws 的证书，可以导入IIS中</p></blockquote><h3 id="方案2" tabindex="-1"><a class="header-anchor" href="#方案2"><span>方案2</span></a></h3><blockquote><p>如果您的电脑未安装openssl，则可以使用python代码进行证书转换</p></blockquote><blockquote><p>代码如下</p></blockquote><div class="language-python line-numbers-mode" data-ext="py" data-title="py"><pre class="language-python"><code>
<span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># @Time    : 2024-03-25 15:26</span>
<span class="token comment"># @Author  : Jack</span>
<span class="token comment"># @File    : 02.convert_ssl_pfx</span>

<span class="token triple-quoted-string string">&quot;&quot;&quot;
02.convert_ssl_pfx
pip install pyOpenSSL==23.2.0
&quot;&quot;&quot;</span>
<span class="token keyword">from</span> OpenSSL <span class="token keyword">import</span> crypto


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>full_chain_path<span class="token punctuation">,</span> key_path<span class="token punctuation">,</span> password<span class="token punctuation">,</span> pfx_result<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>full_chain_path<span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        full_chain_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>key_path<span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        key_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

    cert <span class="token operator">=</span> crypto<span class="token punctuation">.</span>load_certificate<span class="token punctuation">(</span>crypto<span class="token punctuation">.</span>FILETYPE_PEM<span class="token punctuation">,</span> full_chain_data<span class="token punctuation">)</span>
    key <span class="token operator">=</span> crypto<span class="token punctuation">.</span>load_privatekey<span class="token punctuation">(</span>crypto<span class="token punctuation">.</span>FILETYPE_PEM<span class="token punctuation">,</span> key_data<span class="token punctuation">)</span>

    pkcs12 <span class="token operator">=</span> crypto<span class="token punctuation">.</span>PKCS12<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> cert <span class="token keyword">and</span> key<span class="token punctuation">:</span>
        pkcs12<span class="token punctuation">.</span>set_certificate<span class="token punctuation">(</span>cert<span class="token punctuation">)</span>
        pkcs12<span class="token punctuation">.</span>set_privatekey<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>pfx_result<span class="token punctuation">,</span> <span class="token string">&#39;wb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>pkcs12<span class="token punctuation">.</span>export<span class="token punctuation">(</span>passphrase<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token string">r&#39;fullchain.pem&#39;</span><span class="token punctuation">,</span> <span class="token string">r&#39;privkey.pem&#39;</span><span class="token punctuation">,</span>
         <span class="token string">b&#39;xxxxxx&#39;</span><span class="token punctuation">,</span> <span class="token string">r&#39;result.pfx&#39;</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><span style="color:red;"> 特别注意事项</span></p></blockquote>`,11),b=n("br",null,null,-1),_=n("br",null,null,-1),y={href:"https://pypi.org/project/pyOpenSSL/23.3.0/",target:"_blank",rel:"noopener noreferrer"},g=t('<h2 id="导入证书-使iis可以选择使用" tabindex="-1"><a class="header-anchor" href="#导入证书-使iis可以选择使用"><span>导入证书,使IIS可以选择使用</span></a></h2><blockquote><p>把生成的 <code>example.com.pfx</code> 或 <code>result.pfx</code> 复制到windows机器上, 双击文件，选择<code>本地用户</code>,下一步,下一步,下一步...看到<code>导入成功</code>提示即可。<br> 除 <code>本地用户</code> 选择外, 其他选项默认即可,需要密码的话,请输入上面配置的密码<code>xxxxxx</code>。</p></blockquote><h2 id="此时在进入iis中选择证书的话-您就可以选择到您自己的证书了" tabindex="-1"><a class="header-anchor" href="#此时在进入iis中选择证书的话-您就可以选择到您自己的证书了"><span>此时在进入IIS中选择证书的话,您就可以选择到您自己的证书了</span></a></h2><h2 id="测试" tabindex="-1"><a class="header-anchor" href="#测试"><span>测试</span></a></h2>',4),S={href:"https://example.com",target:"_blank",rel:"noopener noreferrer"};function x(f,I){const e=l("ExternalLinkIcon");return i(),c("div",null,[r,n("blockquote",null,[n("p",null,[s("我的需求是在IIS上部署SSL证书，然后可以 "),n("a",u,[s("https://example.com"),a(e)]),s(" 正常访问")])]),d,n("ul",null,[n("li",null,[s("选中IIS中的网站，在右侧Bindings...中添加 "),n("a",k,[s("https://example.com"),a(e)]),s(" , 然后在下面选中"),m]),v]),h,n("blockquote",null,[n("p",null,[s("pyOpenSSL==23.2.0 , 23.2.0之后的版本已经移除 PKCS12"),b,s(" Removed OpenSSL.crypto.loads_pkcs7 and OpenSSL.crypto.loads_pkcs12 which had been deprecated for 3 years."),_,n("a",y,[s("参见"),a(e)])])]),g,n("blockquote",null,[n("p",null,[s("浏览您的网站 "),n("a",S,[s("https://example.com"),a(e)]),s(" 发现可以正常访问。")])])])}const L=p(o,[["render",x],["__file","e781ee.html.vue"]]),T=JSON.parse(`{"path":"/p2024/Linux/cert/e781ee.html","title":"SSL证书在IIS上部署使用","lang":"zh-CN","frontmatter":{"permalink":"/p2024/Linux/cert/e781ee.html","lang":"zh-CN","title":"SSL证书在IIS上部署使用","description":"SSL证书在IIS上部署使用","isOriginal":true,"date":"2024-03-25T00:00:00.000Z","category":["SSL证书","IIS"],"tag":["SSL证书","IIS","PKCS12"],"head":[["meta",{"name":"keywords","content":"SSL证书,IIS,PKCS12"}],["meta",{"property":"og:url","content":"https://hub.nstudy.org/p2024/Linux/cert/e781ee.html"}],["meta",{"property":"og:site_name","content":"Jack's 新学习基地"}],["meta",{"property":"og:title","content":"SSL证书在IIS上部署使用"}],["meta",{"property":"og:description","content":"SSL证书在IIS上部署使用"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-12T06:52:02.000Z"}],["meta",{"property":"article:author","content":"Jack"}],["meta",{"property":"article:tag","content":"SSL证书"}],["meta",{"property":"article:tag","content":"IIS"}],["meta",{"property":"article:tag","content":"PKCS12"}],["meta",{"property":"article:published_time","content":"2024-03-25T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-12T06:52:02.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"SSL证书在IIS上部署使用\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-25T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-12T06:52:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jack\\",\\"url\\":\\"https://hub.nstudy.org\\"}]}"]],"star":true,"sticky":true},"headers":[{"level":2,"title":"背景介绍","slug":"背景介绍","link":"#背景介绍","children":[]},{"level":2,"title":"环境介绍以及依赖版本介绍","slug":"环境介绍以及依赖版本介绍","link":"#环境介绍以及依赖版本介绍","children":[]},{"level":2,"title":"操作方法","slug":"操作方法","link":"#操作方法","children":[{"level":3,"title":"方案1","slug":"方案1","link":"#方案1","children":[]},{"level":3,"title":"方案2","slug":"方案2","link":"#方案2","children":[]}]},{"level":2,"title":"导入证书,使IIS可以选择使用","slug":"导入证书-使iis可以选择使用","link":"#导入证书-使iis可以选择使用","children":[]},{"level":2,"title":"此时在进入IIS中选择证书的话,您就可以选择到您自己的证书了","slug":"此时在进入iis中选择证书的话-您就可以选择到您自己的证书了","link":"#此时在进入iis中选择证书的话-您就可以选择到您自己的证书了","children":[]},{"level":2,"title":"测试","slug":"测试","link":"#测试","children":[]}],"git":{"createdTime":1712904722000,"updatedTime":1712904722000,"contributors":[{"name":"lizhiquan","email":"lizhiquan@jianke.com","commits":1}]},"readingTime":{"minutes":2.44,"words":731},"filePathRelative":"06.Linux/01.cert/20240325_SSL证书在IIS上部署使用.md","localizedDate":"2024年3月25日","excerpt":"<h2>背景介绍</h2>\\n<blockquote>\\n<p>我的需求是在IIS上部署SSL证书，然后可以 <a href=\\"https://example.com\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://example.com</a> 正常访问</p>\\n</blockquote>\\n<blockquote>\\n<p>如果您不是迫不得已，建议使用nginx等web服务器已获得顺畅的https服务</p>\\n</blockquote>\\n<blockquote>\\n<p>nginx SSL 证书配置如下</p>\\n</blockquote>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code>    listen <span class=\\"token number\\">443</span> ssl http2<span class=\\"token punctuation\\">;</span>\\n    listen <span class=\\"token punctuation\\">[</span>::<span class=\\"token punctuation\\">]</span>:443 ssl http2<span class=\\"token punctuation\\">;</span>\\n    ssl_certificate         /etc/nginx/cert/fullchain.pem<span class=\\"token punctuation\\">;</span>\\n    ssl_certificate_key     /etc/nginx/cert/privkey.key<span class=\\"token punctuation\\">;</span>\\n</code></pre></div>"}`);export{L as comp,T as data};
