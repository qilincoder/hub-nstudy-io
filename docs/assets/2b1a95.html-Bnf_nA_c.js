import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as a,c as n,e}from"./app-cApR-bju.js";const r={},o=e(`<h2 id="背景" tabindex="-1"><a class="header-anchor" href="#背景"><span>背景</span></a></h2><blockquote><p>突然某一天harbor密码忘记了,登录不进去了<br> 又或者某一个时刻,明明对的密码就是提示错误<br> 此刻就需要强制重置密码来回复harbor的管理权职责</p></blockquote><blockquote><p>在harbor版本为 <code>v2.9.0</code> 版本上面操作</p></blockquote><h2 id="操作步骤" tabindex="-1"><a class="header-anchor" href="#操作步骤"><span>操作步骤</span></a></h2><blockquote><p>核心脚本 <code>update harbor_user set salt=&#39;&#39;,password=&#39;&#39; where user_id = 1;</code><br> 再次登录会要求初始化新密码</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">docker</span>  <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> harbor-db /bin/bash

psql <span class="token parameter variable">-h</span> postgresql <span class="token parameter variable">-d</span> postgres <span class="token parameter variable">-U</span> postgres
root123
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># \\c registry;</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token comment"># \\d harbor_user;</span>
<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token comment"># show password_encryption;</span>
 password_encryption 
---------------------
 scram-sha-256
<span class="token punctuation">(</span><span class="token number">1</span> row<span class="token punctuation">)</span>

<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token comment"># select user_id,username,password,salt,deleted,password_version from harbor_user order by user_id;</span>
 user_id <span class="token operator">|</span> username  <span class="token operator">|</span>             password             <span class="token operator">|</span>               salt               <span class="token operator">|</span> deleted <span class="token operator">|</span> password_version 
---------+-----------+----------------------------------+----------------------------------+---------+------------------
       <span class="token number">1</span> <span class="token operator">|</span> admin     <span class="token operator">|</span> f6af2cbfdf011cb2e6d90ab74be131ef <span class="token operator">|</span> 48QvleJcZdySDPoLSU9vV5Bip81H6YbV <span class="token operator">|</span> f       <span class="token operator">|</span> sha256
       <span class="token number">2</span> <span class="token operator">|</span> anonymous <span class="token operator">|</span>                                  <span class="token operator">|</span>                                  <span class="token operator">|</span> t       <span class="token operator">|</span> sha1
       <span class="token number">3</span> <span class="token operator">|</span> <span class="token builtin class-name">test</span>      <span class="token operator">|</span> 7dd6cc44ab5ee991fbb1b27c6d49b100 <span class="token operator">|</span> 4yYCpDSnWRd4ryDflJvm9OVOBjGkbzlf <span class="token operator">|</span> f       <span class="token operator">|</span> sha256
<span class="token punctuation">(</span><span class="token number">3</span> rows<span class="token punctuation">)</span>

<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token comment"># update harbor_user  set salt=&#39;&#39;,password=&#39;&#39; where  user_id = 1;</span>
UPDATE <span class="token number">1</span>

重启harbor   admin/Harbor12345

<span class="token assign-left variable">registry</span><span class="token operator">=</span><span class="token comment"># select user_id,username,password,salt,deleted,password_version from harbor_user order by user_id;</span>
 user_id <span class="token operator">|</span> username  <span class="token operator">|</span>             password             <span class="token operator">|</span>               salt               <span class="token operator">|</span> deleted <span class="token operator">|</span> password_version 
---------+-----------+----------------------------------+----------------------------------+---------+------------------
       <span class="token number">1</span> <span class="token operator">|</span> admin     <span class="token operator">|</span> 2fd1afe65dc5460e3a05b32f894893db <span class="token operator">|</span> mtYqbEazoeHvZ4iubu1lDBFWC1CzixNU <span class="token operator">|</span> f       <span class="token operator">|</span> sha256
       <span class="token number">2</span> <span class="token operator">|</span> anonymous <span class="token operator">|</span>                                  <span class="token operator">|</span>                                  <span class="token operator">|</span> t       <span class="token operator">|</span> sha1
       <span class="token number">3</span> <span class="token operator">|</span> <span class="token builtin class-name">test</span>      <span class="token operator">|</span> 7dd6cc44ab5ee991fbb1b27c6d49b100 <span class="token operator">|</span> 4yYCpDSnWRd4ryDflJvm9OVOBjGkbzlf <span class="token operator">|</span> f       <span class="token operator">|</span> sha256
<span class="token punctuation">(</span><span class="token number">3</span> rows<span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),t=[o];function p(l,i){return a(),n("div",null,t)}const b=s(r,[["render",p],["__file","2b1a95.html.vue"]]),u=JSON.parse(`{"path":"/p2024/Linux/harbor/2b1a95.html","title":"harbor修改密码","lang":"zh-CN","frontmatter":{"permalink":"/p2024/Linux/harbor/2b1a95.html","lang":"zh-CN","title":"harbor修改密码","description":"harbor修改密码","isOriginal":true,"date":"2024-03-09T00:00:00.000Z","category":["harbor"],"tag":["harbor"],"head":[["meta",{"name":"keywords","content":"harbor修改密码,harbor"}],["meta",{"property":"og:url","content":"https://hub.nstudy.org/p2024/Linux/harbor/2b1a95.html"}],["meta",{"property":"og:site_name","content":"Jack's 新学习基地"}],["meta",{"property":"og:title","content":"harbor修改密码"}],["meta",{"property":"og:description","content":"harbor修改密码"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-09T01:31:57.000Z"}],["meta",{"property":"article:author","content":"Jack"}],["meta",{"property":"article:tag","content":"harbor"}],["meta",{"property":"article:published_time","content":"2024-03-09T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-09T01:31:57.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"harbor修改密码\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-09T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-09T01:31:57.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jack\\",\\"url\\":\\"https://hub.nstudy.org\\"}]}"]],"star":true,"sticky":true},"headers":[{"level":2,"title":"背景","slug":"背景","link":"#背景","children":[]},{"level":2,"title":"操作步骤","slug":"操作步骤","link":"#操作步骤","children":[]}],"git":{"createdTime":1712626317000,"updatedTime":1712626317000,"contributors":[{"name":"lizhiquan","email":"lizhiquan@jianke.com","commits":1}]},"readingTime":{"minutes":0.87,"words":260},"filePathRelative":"06.Linux/05.harbor/20240309_harbor修改密码.md","localizedDate":"2024年3月9日","excerpt":"<h2>背景</h2>\\n<blockquote>\\n<p>突然某一天harbor密码忘记了,登录不进去了<br>\\n又或者某一个时刻,明明对的密码就是提示错误<br>\\n此刻就需要强制重置密码来回复harbor的管理权职责</p>\\n</blockquote>\\n<blockquote>\\n<p>在harbor版本为 <code>v2.9.0</code> 版本上面操作</p>\\n</blockquote>\\n<h2>操作步骤</h2>\\n<blockquote>\\n<p>核心脚本 <code>update harbor_user  set salt='',password='' where  user_id = 1;</code><br>\\n再次登录会要求初始化新密码</p>\\n</blockquote>"}`);export{b as comp,u as data};
